{% extends "core/base.html" %}
{% load static %}

{% block title %}Air Guitar Pro - Mobile Controller{% endblock %}

{% block extra_js %}
<script src="{% static 'js/air-guitar-pro/webrtc-service.js' %}"></script>
<script src="{% static 'js/air-guitar-pro/mobile-controller.js' %}"></script>
{% endblock %}

{% block content %}
<div class="flex-1 flex flex-col h-screen w-full bg-slate-950 overflow-hidden select-none touch-none font-sans">
  <!-- ステータスバー -->
  <div class="flex items-center justify-between px-6 py-4 bg-slate-900 border-b border-white/5">
    <div class="flex items-center gap-3">
      <div
        id="connection-dot"
        class="w-3 h-3 rounded-full bg-red-500 animate-pulse"></div>
      <span
        id="connection-text"
        class="text-[10px] font-black uppercase tracking-[0.2em] text-white opacity-70">
        LINKING...
      </span>
    </div>
    <div class="text-right">
      <div class="text-[8px] font-bold text-slate-500 uppercase">Room Code</div>
      <div id="room-code-display" class="font-mono text-sm font-black text-orange-500 leading-none">ABCD</div>
    </div>
    <button
      id="exit-btn"
      onclick="controller.exit()"
      class="ml-4 p-2 px-4 bg-white/5 hover:bg-white/10 rounded-xl text-[10px] font-bold border border-white/5">
      EXIT
    </button>
  </div>

  <!-- フレットボードエリア -->
  <div class="flex-1 flex fret-board relative">
    <!-- 弦名表示レール -->
    <div class="w-14 flex flex-col justify-around py-4 bg-black/40 border-r border-white/10 z-20">
      <div class="text-center font-black text-slate-600 text-xs italic">E</div>
      <div class="text-center font-black text-slate-600 text-xs italic">A</div>
      <div class="text-center font-black text-slate-600 text-xs italic">D</div>
      <div class="text-center font-black text-slate-600 text-xs italic">G</div>
      <div class="text-center font-black text-slate-600 text-xs italic">B</div>
      <div class="text-center font-black text-slate-600 text-xs italic">E</div>
    </div>

    <!-- フレットグリッド -->
    <div class="flex-1 flex relative bg-[#0f172a]">
      <!-- フレット垂直線 -->
      <div class="absolute h-full w-[2px] bg-gradient-to-b from-slate-700 via-slate-500 to-slate-700 shadow-[2px_0_5px_rgba(0,0,0,0.5)]" style="left: 25%"></div>
      <div class="absolute h-full w-[2px]" style="left: 50%"></div>
      <div class="absolute h-full w-[2px]" style="left: 75%"></div>

      <!-- 弦とインタラクションレイヤー -->
      <div class="flex-1 flex flex-col py-4">
        <!-- 6弦分ループ -->
      </div>
    </div>
  </div>

  <!-- クイックコードショートカット -->
  <div class="h-28 bg-slate-900/80 border-t border-white/5 p-4 grid grid-cols-4 gap-3 backdrop-blur-xl">
    <button
      id="chord-c-btn"
      onclick="controller.setChord([0,1,0,2,3,0])"
      class="chord-button rounded-2xl border-2 font-black text-lg transition-all active:scale-95">
      C
    </button>
    <button
      id="chord-g-btn"
      onclick="controller.setChord([3,0,0,0,2,3])"
      class="chord-button rounded-2xl border-2 font-black text-lg transition-all active:scale-95">
      G
    </button>
    <button
      id="chord-d-btn"
      onclick="controller.setChord([2,3,2,0,0,0])"
      class="chord-button rounded-2xl border-2 font-black text-lg transition-all active:scale-95">
      D
    </button>
    <button
      id="chord-am-btn"
      onclick="controller.setChord([0,1,2,2,0,0])"
      class="chord-button rounded-2xl border-2 font-black text-lg transition-all active:scale-95">
      Am
    </button>
  </div>

  <!-- 底部オレンジバー -->
  <div class="bg-orange-600 h-1 w-full opacity-50"></div>
</div>

<style>
  .fret-board {
    touch-action: none;
  }

  .chord-button {
    @apply px-6 py-4;
    @apply bg-slate-800;
    @apply text-white;
    @apply font-bold;
    @apply transition-all;
  }

  .chord-button:active,
  .chord-button.chord-active {
    @apply bg-orange-500;
    @apply border-orange-300;
    @apply shadow-orange-500/20;
  }

  .chord-chord-active {
    @apply text-white;
  }
</style>
{% endblock %}
